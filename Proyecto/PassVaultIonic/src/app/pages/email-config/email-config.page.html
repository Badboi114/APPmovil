<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-title>Configuraci√≥n de Email</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="config-content">
  <div class="config-container">
    <ion-card class="config-card">
      <ion-card-header>
        <ion-card-title class="text-center">üìß Configurar EmailJS</ion-card-title>
        <ion-text color="medium" class="text-center">
          <p>Configura tu cuenta de EmailJS para recibir PINs reales por correo</p>
        </ion-text>
      </ion-card-header>

      <ion-card-content>
        <!-- Instrucciones -->
        <div class="instructions-section">
          <ion-text color="primary">
            <h3>üìã Pasos para configurar EmailJS:</h3>
          </ion-text>
          
          <ion-list class="instructions-list">
            <ion-item>
              <ion-icon name="link" color="primary" slot="start"></ion-icon>
              <ion-label>
                <h4>1. Crear cuenta en EmailJS</h4>
                <p>Ve a <strong>https://www.emailjs.com</strong> y crea una cuenta gratuita</p>
              </ion-label>
            </ion-item>

            <ion-item>
              <ion-icon name="settings" color="primary" slot="start"></ion-icon>
              <ion-label>
                <h4>2. Configurar servicio de email</h4>
                <p>Conecta tu Gmail, Outlook u otro proveedor de email</p>
              </ion-label>
            </ion-item>

            <ion-item>
              <ion-icon name="document-text" color="primary" slot="start"></ion-icon>
              <ion-label>
                <h4>3. Crear template</h4>
                <p>Crea un template con variables: to_name, pin, message (usar llaves dobles)</p>
              </ion-label>
            </ion-item>

            <ion-item>
              <ion-icon name="key" color="primary" slot="start"></ion-icon>
              <ion-label>
                <h4>4. Obtener credenciales</h4>
                <p>Copia el Service ID, Template ID y Public Key</p>
              </ion-label>
            </ion-item>
          </ion-list>
        </div>

        <!-- Formulario de configuraci√≥n -->
        <div class="form-section">
          <div class="quick-setup" *ngIf="!configLoaded">
            <ion-button 
              expand="block" 
              fill="outline" 
              color="secondary" 
              (click)="useQuickSetup()"
              class="quick-button">
              ‚ö° Configuraci√≥n R√°pida (Ejemplo)
            </ion-button>
          </div>

          <ion-item class="input-item">
            <ion-label position="stacked" color="primary">
              <strong>Service ID *</strong>
            </ion-label>
            <ion-input 
              type="text" 
              [(ngModel)]="serviceId" 
              placeholder="service_xxxxxxxx"
              fill="outline"
              required>
            </ion-input>
          </ion-item>

          <ion-item class="input-item">
            <ion-label position="stacked" color="primary">
              <strong>Template ID *</strong>
            </ion-label>
            <ion-input 
              type="text" 
              [(ngModel)]="templateId" 
              placeholder="template_xxxxxxxx"
              fill="outline"
              required>
            </ion-input>
          </ion-item>

          <ion-item class="input-item">
            <ion-label position="stacked" color="primary">
              <strong>Public Key *</strong>
            </ion-label>
            <ion-input 
              type="text" 
              [(ngModel)]="publicKey" 
              placeholder="xxxxxxxxxxxxxxxx"
              fill="outline"
              required>
            </ion-input>
          </ion-item>

          <!-- Secci√≥n de prueba -->
          <div class="test-section">
            <ion-item class="input-item">
              <ion-label position="stacked" color="secondary">
                <strong>Email de Prueba</strong>
              </ion-label>
              <ion-input 
                type="email" 
                [(ngModel)]="testEmail" 
                placeholder="tu@email.com"
                fill="outline">
              </ion-input>
            </ion-item>

            <ion-button 
              expand="block" 
              color="secondary" 
              (click)="testConfiguration()"
              [disabled]="isTesting"
              class="test-button">
              <ion-spinner *ngIf="isTesting" name="crescent"></ion-spinner>
              <span *ngIf="!isTesting">üß™ Probar Configuraci√≥n</span>
            </ion-button>
          </div>

          <ion-button 
            expand="block" 
            color="primary" 
            (click)="saveConfiguration()"
            class="save-button">
            üíæ Guardar Configuraci√≥n
          </ion-button>

          <div class="action-buttons">
            <ion-button 
              expand="block" 
              fill="outline" 
              color="medium" 
              (click)="goToLogin()"
              class="skip-button">
              ‚è≠Ô∏è Omitir por ahora (usar modo demo)
            </ion-button>

            <ion-button 
              expand="block" 
              fill="outline" 
              color="danger" 
              (click)="resetConfiguration()"
              class="reset-button"
              *ngIf="configLoaded">
              üîÑ Reiniciar Configuraci√≥n
            </ion-button>
          </div>
        </div>

        <!-- Nota informativa -->
        <div class="info-section">
          <ion-text color="medium">
            <p class="info-text">
              <ion-icon name="information-circle" color="primary"></ion-icon>
              Si omites la configuraci√≥n, los PINs se mostrar√°n en pantalla en modo demo.
            </p>
          </ion-text>
        </div>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>
